---
import { siteConfig } from '@/config/site';

interface Props {
  data?: object;
}

const { data } = Astro.props;

// Default PhysicalTherapy business schema
const defaultSchema = {
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': ['PhysicalTherapy', 'MedicalBusiness', 'LocalBusiness'],
      '@id': `${siteConfig.url}/#organization`,
      name: siteConfig.name,
      alternateName: siteConfig.shortName,
      url: siteConfig.url,
      logo: {
        '@type': 'ImageObject',
        url: `${siteConfig.url}/images/logo.png`,
      },
      image: `${siteConfig.url}/images/ashlee-gendron.jpg`,
      description: siteConfig.description,
      telephone: `+1-${siteConfig.contact.phone.primary}`,
      email: siteConfig.contact.email,
      priceRange: '$$',
      medicalSpecialty: ['Physical Therapy', 'Womens Health'],
      knowsAbout: [
        'Pelvic Floor Physical Therapy',
        'Women\'s Health Physical Therapy',
        'Postpartum Recovery',
        'Concierge Home Visit Physical Therapy',
        'Orthopedic Physical Therapy',
        'Pelvic Pain Treatment',
        'Diastasis Recti Rehabilitation',
        'Pregnancy Physical Therapy',
      ],
      address: {
        '@type': 'PostalAddress',
        streetAddress: siteConfig.contact.address.street,
        addressLocality: siteConfig.contact.address.city,
        addressRegion: siteConfig.contact.address.state,
        postalCode: siteConfig.contact.address.zip,
        addressCountry: 'US',
      },
      geo: {
        '@type': 'GeoCoordinates',
        latitude: siteConfig.contact.geo.lat,
        longitude: siteConfig.contact.geo.lng,
      },
      openingHoursSpecification: [
        {
          '@type': 'OpeningHoursSpecification',
          dayOfWeek: ['Wednesday', 'Friday'],
          opens: '09:00',
          closes: '13:00',
          description: 'In-clinic appointments at San Diego County Midwives HQ',
        },
      ],
      founder: {
        '@type': 'Person',
        name: siteConfig.provider.name,
        jobTitle: siteConfig.provider.title,
        description: `${siteConfig.provider.credentials} - ${siteConfig.provider.title} specializing in pelvic health and orthopedics. Boutique concierge practice offering one-on-one care with home visits throughout North County San Diego.`,
      },
      // Area served
      areaServed: siteConfig.serviceAreas.map((city) => ({
        '@type': city === 'North County San Diego' ? 'AdministrativeArea' : 'City',
        name: city,
        ...(city !== 'North County San Diego' && {
          containedInPlace: {
            '@type': 'State',
            name: 'California',
          },
        }),
      })),
      aggregateRating: {
        '@type': 'AggregateRating',
        ratingValue: siteConfig.googleReviews.rating,
        reviewCount: siteConfig.googleReviews.reviewCount,
        bestRating: 5,
        worstRating: 1,
      },
      sameAs: Object.values(siteConfig.social),
      hasOfferCatalog: {
        '@type': 'OfferCatalog',
        name: 'Physical Therapy Services',
        itemListElement: siteConfig.services.map((service) => ({
          '@type': 'Offer',
          itemOffered: {
            '@type': 'Service',
            name: service.name,
            description: service.description,
          },
        })),
      },
    },
    {
      '@type': 'WebSite',
      '@id': `${siteConfig.url}/#website`,
      url: siteConfig.url,
      name: siteConfig.name,
      description: siteConfig.tagline,
      publisher: { '@id': `${siteConfig.url}/#organization` },
      inLanguage: 'en-US',
    },
    {
      '@type': 'FAQPage',
      '@id': `${siteConfig.url}/#faq`,
      mainEntity: siteConfig.faq.map((item) => ({
        '@type': 'Question',
        name: item.question,
        acceptedAnswer: {
          '@type': 'Answer',
          text: item.answer,
        },
      })),
    },
    // Reviews/Testimonials
    ...siteConfig.testimonials.map((testimonial, index) => ({
      '@type': 'Review',
      '@id': `${siteConfig.url}/#review-${index + 1}`,
      itemReviewed: {
        '@id': `${siteConfig.url}/#organization`,
      },
      reviewRating: {
        '@type': 'Rating',
        ratingValue: 5,
        bestRating: 5,
        worstRating: 1,
      },
      reviewBody: testimonial.quote,
      author: {
        '@type': 'Person',
        name: testimonial.author,
      },
    })),
  ],
};

const jsonLd = data || defaultSchema;
---

<script type="application/ld+json" set:html={JSON.stringify(jsonLd)} />
